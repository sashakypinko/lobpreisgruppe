import{n as E,j as e,a as P,u as q,bg as F,ad as I,r as u,d as M,h as C,A as b,e as p,a2 as j,T as O,bh as G,a9 as i,as as H,f as y,U}from"./index.08fe98f9.js";import{C as D}from"./isTypedArray.de5e219e.js";import{u as W,c as J,C as K}from"./CustomCheckboxAutocomplete.58ff2ea6.js";import{u as Q}from"./useError.062e31d1.js";import{a as X}from"./SongEnums.a1949f60.js";const Y=E(e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),Z=E(e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z"}),"RemoveCircleOutlined"),ee={container:{margin:0},title:{marginBottom:"10px"},actionButton:{marginTop:"16px"},divider:{margin:"40px 0"},saveButton:{marginTop:"32px !important"}},ae=()=>{const{t:l}=P(),c=q(ee),{id:x}=F(),T=I(),h={name:"",tags:[],lang:""},[m,v]=u.exports.useState([]),[n,d]=u.exports.useState([{...h}]),{loading:k,Loading:R,setLoading:f}=M(),{createSuccessSnackbar:z,createErrorSnackbar:A}=W(),[_,$]=u.exports.useMemo(()=>{const a={},t={};return n.forEach((r,s)=>{a[`name_${s}`]={type:"isEmpty",text:"songs.nameIsRequired"},a[`lang_${s}`]={type:"isEmpty",text:"songs.langIsRequired"},t[`name_${s}`]=r.name,t[`lang_${s}`]=r.lang}),[a,t]},[n]),{getActivateError:B,isError:S,deactivateError:se}=Q({values:$,validations:_});u.exports.useEffect(()=>{(async()=>{const a=await C.postRequest(b.getAllTags);a.ok&&v(a.data.tags.map(({name:t})=>t))})()},[]);const g=({name:a,value:t,index:r})=>{const s={...n[r]};d([...n.slice(0,r),{...s,[a]:t},...n.slice(r+1)])},N=(a,t)=>{a.forEach(r=>{m.includes(r)||v([...m,r])}),g({name:"tags",value:a,index:t})},w=a=>{d([...n.slice(0,a),...n.slice(a+1)])},V=()=>{d([...n,{...h}])},L=async()=>{if(f(!0),!B()){const t=x==="new"?"create":"update";(await C.postRequest(b[`${t}Songs`],{songs:n})).ok?(z(l("supplierProfiles.cantSaveSupplierProfile")),T(U.SONGS)):A(l("supplierProfiles.cantSaveSupplierProfile"))}f(!1)};return k?e(R,{}):p(j,{children:[e(O,{className:c.title,variant:"h1",children:l("songs.editTitle")}),e(G,{className:c.divider}),p(i,{container:!0,spacing:2,children:[n.map(({name:a,tags:t,lang:r},s)=>p(i,{container:!0,spacing:2,className:c.container,children:[e(i,{item:!0,xs:6,md:3,children:e(D,{uiLibrary:"mui",label:l("name"),value:a,onChange:({value:o})=>g({name:"name",value:o,index:s}),fullWidth:!0,className:c.textField,error:S(`name_${s}`)})}),e(i,{item:!0,xs:6,md:4,children:e(J,{label:l("languages"),value:r,options:X.map(o=>({text:o,value:o})),onChange:({value:o})=>g({name:"lang",value:o,index:s}),size:"small",error:S(`lang_${s}`)})}),e(i,{item:!0,xs:9,md:4,children:e(K,{options:m.map(o=>({key:o,name:o})),value:t,label:l("tags"),openOnFocus:!0,onChange:({value:o})=>N(o,s),size:"small",freeSolo:!0})}),e(i,{item:!0,xs:3,md:1,children:e(H,{"aria-label":"remove",className:c.actionButton,disabled:n.length<2,onClick:()=>w(s),children:e(Z,{fontSize:"large",color:n.length<2?"disabled":"error"})})})]},`song_row_${s}`)),e(i,{item:!0,xs:12,children:e(y,{variant:"outline",size:"small",onClick:V,children:e(Y,{})})}),e(i,{item:!0,xs:12,children:e(y,{className:c.saveButton,variant:"outline",size:"small",intent:"primary",onClick:L,fullMobile:!0,children:l("songs.save")})})]})]})};ae.propTypes={};export{ae as default};
